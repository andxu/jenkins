{
    "partner": "docs",
    "workflow":[
        {
            "branch": "develop",
            "jobs":[
                {
                    "name": "develop_ci",
                    "template": "node",
                    "shell":[
                        "npm install",
                        "npm run opst init",
                        "npm run opst -- deployTheme -B ${codeBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersAlwaysEnabled": true
                },

                {
                    "name": "develop_opbuild",
                    "template": "node",
                    "triggersUpstream": "develop_ci",
                    "shell":[
                        "npm install \n",
                        "gulp merge --repo openpublishing-test --gitUser Microsoft --gitToken 46b91c61e451d012b9a71fcbc7a69c2a7a8c6c89 --sourceBranch master --targetBranch ${contentBranch}",
                        "gulp triggerBuild --buildEndpoint ${opbuildEndpoint} --buildBranch ${contentBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersFailureEnabled": true,
                    "triggersFixedEnabled": true
                },

                {
                    "name": "develop_e2e",
                    "template": "protractor",
                    "triggerEnabled": true,
                    "triggersUpstream": "develop_opbuild",
                    "shell":[
                        "npm install \n",
                        "gulp merge --repo openpublishing-test --gitUser Microsoft --gitToken 46b91c61e451d012b9a71fcbc7a69c2a7a8c6c89 --sourceBranch master --targetBranch ${contentBranch}",
                        "gulp triggerBuild --buildEndpoint ${opbuildEndpoint} --buildBranch ${contentBranch}"
                    ],
                    "publishers":{
                        "artifactArchiverEnabled": true,
                        "extendedEmailEnabled": true,
                        "triggersFailureEnabled": true,
                        "triggersFixedEnabled": true
                    }
                },

                {
                    "name": "develop_merge",
                    "template": "node",
                    "triggersUpstream": "develop_e2e",
                    "git":{
                        "name": "Template.Docs",
                        "mergeOptions": true,
                        "mergeBranch": "release",
                        "mergeRemote": "Template.Docs"
                    },
                    "shellEnabled": false,
                    "gitPublisherEnabled": true
                }
            ]
        },

        {
            "branch": "release",
            "jobs":[
                {
                    "name": "release_ci",
                    "template": "node",
                    "shell":[
                        "npm install",
                        "npm run opst init",
                        "npm run opst -- deployTheme -B ${codeBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersAlwaysEnabled": true
                },

                {
                    "name": "release_opbuild",
                    "template": "node",
                    "triggersUpstream": "release_ci",
                    "shell":[
                        "npm install \n",
                        "gulp merge --repo openpublishing-test --gitUser Microsoft --gitToken 46b91c61e451d012b9a71fcbc7a69c2a7a8c6c89 --sourceBranch master --targetBranch ${contentBranch}",
                        "gulp triggerBuild --buildEndpoint ${opbuildEndpoint} --buildBranch ${contentBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersFailureEnabled": true,
                    "triggersFixedEnabled": true
                },

                {
                    "name": "release_e2e",
                    "template": "protractor",
                    "triggerEnabled": true,
                    "triggersUpstream": "release_opbuild",
                    "shell":[
                        "npm install \n",
                        "gulp merge --repo openpublishing-test --gitUser Microsoft --gitToken 46b91c61e451d012b9a71fcbc7a69c2a7a8c6c89 --sourceBranch master --targetBranch ${contentBranch}",
                        "gulp triggerBuild --buildEndpoint ${opbuildEndpoint} --buildBranch ${contentBranch}"
                    ],
                    "publishers":{
                        "artifactArchiverEnabled": true,
                        "extendedEmailEnabled": true,
                        "triggersFailureEnabled": true,
                        "triggersFixedEnabled": true
                    }
                }
            ]
        },

        {
            "branch": "hotfix",
            "jobs":[
                {
                    "name": "hotfix_ci",
                    "template": "node",
                    "shell":[
                        "npm install",
                        "npm run opst init",
                        "npm run opst -- deployTheme -B ${codeBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersAlwaysEnabled": true
                },

                {
                    "name": "hotfix_opbuild",
                    "template": "node",
                    "triggersUpstream": "hotfix_ci",
                    "shell":[
                        "npm install \n",
                        "gulp merge --repo openpublishing-test --gitUser Microsoft --gitToken 46b91c61e451d012b9a71fcbc7a69c2a7a8c6c89 --sourceBranch master --targetBranch ${contentBranch}",
                        "gulp triggerBuild --buildEndpoint ${opbuildEndpoint} --buildBranch ${contentBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersFailureEnabled": true,
                    "triggersFixedEnabled": true
                },

                {
                    "name": "hotfix_e2e",
                    "template": "protractor",
                    "triggerEnabled": true,
                    "triggersUpstream": "hotfix_opbuild",
                    "shell":[
                        "npm install \n",
                        "gulp merge --repo openpublishing-test --gitUser Microsoft --gitToken 46b91c61e451d012b9a71fcbc7a69c2a7a8c6c89 --sourceBranch master --targetBranch ${contentBranch}",
                        "gulp triggerBuild --buildEndpoint ${opbuildEndpoint} --buildBranch ${contentBranch}"
                    ],
                    "publishers":{
                        "artifactArchiverEnabled": true,
                        "extendedEmailEnabled": true,
                        "triggersFailureEnabled": true,
                        "triggersFixedEnabled": true
                    }
                },

                {
                    "name": "hotfix_merge",
                    "template": "node",
                    "triggersUpstream": "hotfix_e2e",
                    "git":{
                        "name": "Template.Docs",
                        "mergeOptions": true,
                        "mergeBranch": "release",
                        "mergeRemote": "Template.Docs"
                    },
                    "shellEnabled": false,
                    "gitPublisherEnabled": true
                }
            ]
        },

        {
            "branch": "master",
            "jobs":[
                {
                    "name": "master_ci",
                    "template": "node",
                    "shell":[
                        "npm install",
                        "npm run opst init",
                        "npm run opst -- deployTheme -B ${codeBranch}"
                    ],
                    "extendedEmailEnabled": true,
                    "triggersAlwaysEnabled": true
                }

            ]
        }
    ]
}